<!DOCTYPE html PUBLIC "-//W3C//DTD html 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8" />
<title>Jenetics: Java Genetic Algorithm library</title>
<meta name="author" content="Franz Wilhelmstötter" />
<meta name="KEYWORDS"
	content="Java, GA, Genetic Algorithm, Jenetics, LGPL, optimization, Artificial Intelligence, software, source, algorithm" />
<meta name="copyright" content="Franz Wilhelmstötter" />
<meta name="robots" content="all" />
<meta name="robots" content="index" />

<link rel="stylesheet" href="styletext.css" type="text/css" />
<link rel="stylesheet" href="stylelayout.css" type="text/css" />
<link rel="stylesheet" href="stylecolor.css" type="text/css" />
<link href="shCore.css" rel="stylesheet" type="text/css" />

<link href="shThemeEclipse.css" rel="stylesheet" type="text/css" />
</head>

<body>
<!-- Scripts for syntax highlighter -->
<script type="text/javascript" src="shCore.js"></script>
<script type="text/javascript" src="shBrushJava.js"></script>
<script type="text/javascript" src="shBrushPlain.js"></script>


<div id="bodywrap-top">
<div id="bodywrap-btm">
<div id="bodywrap-r">
<div id="bodywrap-l">
<div id="bodywrap-tl">
<div id="bodywrap-tr">
<div id="bodywrap-br">
<div id="bodywrap-bl">
<div id="bodywrap-in">

<div id="pageframe">

<div id="titlearea">
<h1>Jenetics &mdash; Java Genetic Algorithm</h1>
</div>
<!-- titlearea close -->

<div id="topmenuback"><!--@topmenu.content--></div>
<!-- topmenuback close --> <!--XXXXXXXXXXXXXXXXThe side bar region starts hereXXXXXXXXXXXXXXXXXXX-->

<div id="leftarea">
<div class="menubox"><a class="sidemenutextlive"
	title="Side menu access to Home" tabindex="1" href="index.html">Home</a>
</div>

<div class="submenubox"><a class="sidesubmenutext"
	title="Examples" tabindex="3" href="examples.html">Examples</a></div>

<div class="submenubox"><a class="sidesubmenutext" title="Javadoc"
	tabindex="4" href="javadoc/index.html">Javadoc</a></div>

<div class="submenubox"><a class="sidesubmenutext"
	title="download" tabindex="5"
	href="https://sourceforge.net/project/showfiles.php?group_id=206158">Download</a>
</div>
</div>
<!-- sidearea close --> <!--XXXXXXXXXXXXXXXXThe main center region starts hereXXXXXXXXXXXXXXXXXXX-->

<div id="column3"><!--@column3.content--></div>
<!-- column3 close -->

<div id="centerarea">

<h2>Examples</h2>

<h3>Ones Counting</h3>

<p>Ones counting is one of the simplest model-problem and consists
of a binary chromosome. The fitness of a Genotype is proportional to the
number of ones. The FitnessFunction looks like this:</p>

<div style="font-size: .75em"><pre
	class="brush: java; toolbar: false;">
import org.jenetics.BitChromosome;
import org.jenetics.BitGene;
import org.jenetics.GeneticAlgorithm;
import org.jenetics.Genotype;
import org.jenetics.Mutator;
import org.jenetics.NumberStatistics;
import org.jenetics.Optimize;
import org.jenetics.RouletteWheelSelector;
import org.jenetics.SinglePointCrossover;
import org.jenetics.util.Factory;
import org.jenetics.util.Function;

final class OneCounter
	implements Function&lt;Genotype&lt;BitGene&gt;, Integer&gt;
{
	@Override
	public Integer apply(Genotype&lt;BitGene&gt; genotype) {
		int count = 0;
		for (BitGene gene : genotype.getChromosome()) {
			if (gene.getBit()) {
				++count;
			}
		}
		return count;
	}
}

public class OnesCounting {
	public static void main(String[] args) {
		Factory&lt;Genotype&lt;BitGene&gt;&gt; gtf = Genotype.valueOf(
			new BitChromosome(20, 0.15)
		);
		Function&lt;Genotype&lt;BitGene&gt;, Integer&gt; ff = new OneCounter();
		GeneticAlgorithm&lt;BitGene, Integer&gt; ga = 
			new GeneticAlgorithm&lt;&gt;(gtf, ff, Optimize.MAXIMUM);

		ga.setStatisticsCalculator(
			new NumberStatistics.Calculator&lt;BitGene, Integer&gt;()
		);
		ga.setPopulationSize(50);
		ga.setSelectors(
			new RouletteWheelSelector&lt;BitGene, Integer&gt;()
		);
		ga.setAlterers(
			new Mutator&lt;BitGene&gt;(0.55),
			new SinglePointCrossover&lt;BitGene&gt;(0.06)
		);

		ga.setup();
		ga.evolve(100);
		System.out.println(ga.getBestStatistics());
	}
}
</pre></div>

<p>
The genotype in this example consists of one BitChromosome with a ones
probability of 0.15. The altering of the offspring population is performed by
mutation, with mutation probability of 0.55, and then by a single-point
crossover, with crossover probability of 0.06. After creating the initial
population, with the ga.setup() call, 100 generations are evolved. The
tournament selector is used for both, the offspring- and the survivor
selection---this is the default selector.
</p>

<div style="font-size: .75em"><pre
	class="brush: java; toolbar: false;">
  +---------------------------------------------------------+
  |  Population Statistics                                  |
  +---------------------------------------------------------+
  |                     Age mean: 1.36000000000             |
  |                 Age variance: 3.74530612245             |
  |                      Samples: 50                        |
  |                 Best fitness: 18                        |
  |                Worst fitness: 5                         |
  +---------------------------------------------------------+
  +---------------------------------------------------------+
  |  Fitness Statistics                                     |
  +---------------------------------------------------------+
  |                 Fitness mean: 12.30000000000            |
  |             Fitness variance: 8.25510204082             |
  |        Fitness error of mean: 1.73948268172             |
  +---------------------------------------------------------+
</pre></div>
	
<p>
The given example will print the overall timing statistics onto the console. 
</p>


<h3>0/1 Knapsack Problem</h3>

<p>In the knapsack problem a set of items, together with their size
and value, is given. The task is to select a disjoint subset so that the
total size does not exeed the knapsacks size. (<a
	href="http://en.wikipedia.org/wiki/Knapsack_problem">Wikipedia:
Knapsack problem</a>) For the 0/1 knapsack problem we define a
BitChromosome, one bit for each item. If the i<sup>th</sup> BitGene is
set to one the i<sup>th</sup> item is selected.</p>

<div style="font-size: .75em"><pre
	class="brush: java; toolbar: false;">
import org.jscience.mathematics.number.Float64;

import org.jenetics.BitChromosome;
import org.jenetics.BitGene;
import org.jenetics.Chromosome;
import org.jenetics.GeneticAlgorithm;
import org.jenetics.Genotype;
import org.jenetics.Mutator;
import org.jenetics.NumberStatistics;
import org.jenetics.RouletteWheelSelector;
import org.jenetics.SinglePointCrossover;
import org.jenetics.util.Factory;
import org.jenetics.util.Function;

final class Item {
	public double size;
	public double value;
}

final class KnappsackFunction
	implements Function&lt;Genotype&lt;BitGene&gt;, Float64&gt;
{
	private final Item[] _items;
	private final double _size;

	public KnappsackFunction(final Item[] items, double size) {
		_items = items;
		_size = size;
	}

	public Item[] getItems() {
		return _items;
	}

	@Override
	public Float64 apply(final Genotype&lt;BitGene&gt; genotype) {
		final Chromosome&lt;BitGene&gt; ch = genotype.getChromosome();

		double size = 0;
		double value = 0;
		for (int i = 0, n = ch.length(); i &lt; n; ++i) {
			if (ch.getGene(i).getBit()) {
				size += _items[i].size;
				value += _items[i].value;
			}
		}

		if (size &gt; _size) {
			return Float64.ZERO;
		} else {
			return Float64.valueOf(value);
		}
	}
}

public class Knapsack {

	private static KnappsackFunction FF(int n, double size) {
		Item[] items = new Item[n];
		for (int i = 0; i &lt; items.length; ++i) {
			items[i] = new Item();
			items[i].size = (Math.random() + 1)*10;
			items[i].value = (Math.random() + 1)*15;
		}

		return new KnappsackFunction(items, size);
	}

	public static void main(String[] argv) throws Exception {
		KnappsackFunction ff = FF(15, 100);
		Factory&lt;Genotype&lt;BitGene&gt;&gt; genotype = Genotype.valueOf(
			new BitChromosome(15, 0.5)
		);

		GeneticAlgorithm&lt;BitGene, Float64&gt; ga = 
			new GeneticAlgorithm&lt;&gt;(genotype, ff);
		
		ga.setMaximalPhenotypeAge(30);
		ga.setPopulationSize(100);
		ga.setStatisticsCalculator(
			new NumberStatistics.Calculator&lt;BitGene, Float64&gt;()
		);
		ga.setSelectors(
			new RouletteWheelSelector&lt;BitGene, Float64&gt;()
		);
		ga.setAlterers(
			 new Mutator&lt;BitGene&gt;(0.115),
			 new SinglePointCrossover&lt;BitGene&gt;(0.16)
		);

		ga.setup();
		ga.evolve(100);
		System.out.println(ga.getBestStatistics());
	}
}
</pre></div>

<p>
The console out put for the Knapsack GA will look like the listing beneath.
</p>

<div style="font-size: .75em"><pre
	class="brush: java; toolbar: false;">
  +---------------------------------------------------------+
  |  Population Statistics                                  |
  +---------------------------------------------------------+
  |                     Age mean: 1.55000000000             |
  |                 Age variance: 2.69444444444             |
  |                      Samples: 100                       |
  |                 Best fitness: 188.57227213871303        |
  |                Worst fitness: 0.0                       |
  +---------------------------------------------------------+
  +---------------------------------------------------------+
  |  Fitness Statistics                                     |
  +---------------------------------------------------------+
  |                 Fitness mean: 157.60654768894           |
  |             Fitness variance: 1486.23455609328          |
  |        Fitness error of mean: 15.76065476889            |
  +---------------------------------------------------------+
</pre></div>


<h3>Traveling Salesman Problem (TSP)</h3>

<p>
The Traveling Salesman problem is a very good example which shows you how to
solve combinatorial problems with an GA. <strong>Jenetics</strong> contains
several classes which will work very well with this kind of problems. Wrapping
the base <em>type</em> into an EnumGene is the first thing to do. In our
example, every city has an unique number, that means we are wrapping an
Integer into an EnumGene. Creating a genotype for integer values is very easy
with the factory method of the PermutationChromosome. For other data types you
have to use one of the constructors of the permutation chromosome. As
alterers, we are using a swap-mutator and a partially-matched crossover. These
alterers guarantees that no invalid solutions are created&mdash;every city
exists exactly once in the altered chromosomes.
</p>

<div style="font-size: .75em"><pre
	class="brush: java; toolbar: false;">
import static java.lang.Math.PI;
import static java.lang.Math.abs;
import static java.lang.Math.sin;

import org.jenetics.Chromosome;
import org.jenetics.EnumGene;
import org.jenetics.GeneticAlgorithm;
import org.jenetics.Genotype;
import org.jenetics.NumberStatistics.Calculator;
import org.jenetics.Optimize;
import org.jenetics.PartiallyMatchedCrossover;
import org.jenetics.PermutationChromosome;
import org.jenetics.SwapMutator;
import org.jenetics.util.Factory;
import org.jenetics.util.Function;

class FF
	implements Function&lt;Genotype&lt;EnumGene&lt;Integer&gt;&gt;, Float64&gt;
{
	private final double[][] _adjacence;
	public FF(final double[][] adjacence) {
		_adjacence = adjacence;
	}
	@Override
	public Float64 apply(Genotype&lt;EnumGene&lt;Integer&gt;&gt; genotype) {
		Chromosome&lt;EnumGene&lt;Integer&gt;&gt; path = 
			genotype.getChromosome();

		double length = 0.0;
		for (int i = 0, n = path.length(); i &lt; n; ++i) {
			final int from = path.getGene(i).getAllele();
			final int to = path.getGene((i + 1)%n).getAllele();
			length += _adjacence[from][to];
		}
		return Float64.valueOf(length);
	}
}

public class TravelingSalesman {

	public static void main(String[] args) {
		final int stops = 20;

		Function&lt;Genotype&lt;EnumGene&lt;Integer&gt;&gt;, Float64&gt; ff = 
			new FF(adjacencyMatrix(stops));
		Factory&lt;Genotype&lt;EnumGene&lt;Integer&gt;&gt;&gt; gt = Genotype.valueOf(
			PermutationChromosome.ofInteger(stops)
		);
		final GeneticAlgorithm&lt;EnumGene&lt;Integer&gt;, Float64&gt;
			ga = new GeneticAlgorithm&lt;&gt;(gt, ff, Optimize.MINIMUM);
		ga.setStatisticsCalculator(
			new Calculator&lt;EnumGene&lt;Integer&gt;, Float64&gt;()
		);
		ga.setPopulationSize(300);
		ga.setAlterers(
			new SwapMutator&lt;EnumGene&lt;Integer&gt;&gt;(0.2),
			new PartiallyMatchedCrossover&lt;Integer&gt;(0.3)
		);

		ga.setup();
		ga.evolve(700);
		System.out.println(ga.getBestStatistics());
		System.out.println(ga.getBestPhenotype());
	}

	private static double[][] adjacencyMatrix(int stops) {
		double[][] matrix = new double[stops][stops];
		for (int i = 0; i &lt; stops; ++i) {
			for (int j = 0; j &lt; stops; ++j) {
				matrix[i][j] = chord(stops, abs(i - j), RADIUS);
			}
		}
		return matrix;
	}
	private static double chord(int stops, int i, double r) {
		return 2.0*r*abs(sin((PI*i)/stops));
	}
	private static double RADIUS = 10.0;
}
</pre></div>

<p>
The listing above shows the output generated by our example. The last line
represents the phenotype of the best solution found by the GA, which
represents the traveling path. As you can see, the GA has found the shortest
path, in reverse order.
</p>

<div style="font-size: .75em"><pre
	class="brush: java; toolbar: false;">
  +---------------------------------------------------------+
  |  Population Statistics                                  |
  +---------------------------------------------------------+
  |                     Age mean: 1.48333333333             |
  |                 Age variance: 3.72212931996             |
  |                      Samples: 300                       |
  |                 Best fitness: 62.573786016092335        |
  |                Worst fitness: 315.49784819824816        |
  +---------------------------------------------------------+
  +---------------------------------------------------------+
  |  Fitness Statistics                                     |
  +---------------------------------------------------------+
  |                 Fitness mean: 118.87334461782           |
  |             Fitness variance: 6464.82405084876          |
  |        Fitness error of mean: 6.86315575146             |
  +---------------------------------------------------------+
  [19|18|17|16|15|14|13|12|11|10|9|8|7|6|5|4|3|2|1|0] --> 62.573786016092335
</pre></div>

</div>
<!-- centerarea close -->

<div id="bottombar">
<h6>&copy; Copyright Franz Wilhelmst&ouml;tter</h6>
<h6><script type="text/javascript" src="http://www.ohloh.net/p/89791/widgets/project_thin_badge.js"></script></h6>
</div>
<!-- bottombar close -->

<div class="spacer"></div>

</div>
<!-- frame close --></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- bodywrap close -->
<script type="text/javascript">
     SyntaxHighlighter.all()
</script>
</body>
</html>
